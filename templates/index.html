<!doctype html>
<html>
<head>
<title>League of Interns</title>
<link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />
<link type="text/css" rel="stylesheet" href="/stylesheets/jquery.countdown.css" />
</head>
<body>

<div id="wrapper">

<div id="header">
    <h1>League of Interns</h1>
    <h2>An internal <a href="http://en.wikipedia.org/wiki/Assassin_(game)">assassins</a>
        game for the summer MTV interns of 2012</h2>
</div>

{# TODO(billycao): Add wrapper/styles for this #}
{% if FLAGS_show_game_title  %}
    <h1>Game: {{ curr_game }}</h1>
{% endif %}

{% if game_started %}
<div id="status">
  {% if winner %}
      {{ winner.assassin }} won.
  {% else %}{% if target_mission %}
      Your target is <strong>{{ target_mission.victim|default:"unassigned" }}</strong>.
      <form id="killform" action="/kill" method="post">
        <input type="text" id="killcode" name="killcode" />
        <label for="killcode">Press 'Enter' to submit your kill code.</label>
      </form>
  {% else %}
      You are dead. :(
  {% endif %}{% endif %}
</div>
{% else %}
<div id="countdown_wrapper">
	<div id="countdown"></div>
	<p id="note" class="note"></p>
</div>

<div id="register_wrapper">
    {% if is_registered %}
        Congratulations! You've joined the game as <b>{{ user_name }}</b>.<br /><br />
        Come back when the game begins for your first target!<br /><br/>
        <b>{{ num_players|add:-1 }} other interns have joined you in the fray!</b>
    {% else %}
        <form action="/join" method="post">
            <fieldset>
                Are you an intern? What are you waiting for? <br />
                Join the other <b>{{ num_players }}</b> assassin{{ num_players|pluralize }}!<br />
                {# TODO(billycao): Make this system work for multiple games. #}
                <select name="game_name" hidden>
                    {% for game in games %}
                        <option>{{ game.key.name }}</option>
                    {% endfor %}
                </select>
                <input class="big_button" type="submit" value="Join the fray!"><br />
                <small>Your username <b>{{ user_name }}</b> will be recorded.</small>
            </fieldset>
        </form>
    {% endif %}
</div>
{% endif %}

<div id="column_wrapper">
    <div onclick="selectColumn('rules')"><div class="column_title"><h3><b>&raquo;</b> Rules</h3></div></div>
    <div id="rules" class="column">
        <i>How to play:</i>
        <p>&nbsp;&nbsp;Assassins is a game of cleverness and stealth. You will be given a target, and your job is to eliminate that target by
        clipping a hairpin onto their clothes. You will be given a kill code that the target must enter into this site once they are killed.
        Otherwise, your kill will not be counted.</p>
        <p>&nbsp;&nbsp;But don't relax too much -- there will be an assassin after you as well. If you are killed, be honorable and properly admit to your kill as soon as possible so that targets may be transferred.</p>
        <p>&nbsp;&nbsp;Once a target is killed, that target's target will become the killer's new target. Targets will continue to be transferred until there is one person left.</p>

        <ol>
            <li>Do not disrupt others.</li>
            <li>No indoor kills. Playing the game indoors is disruptful.</li>
            <li>Do not hurt anyone, including your target.</li>
            <li>Only target your own target.</li>
            <li>Be honest. If you were killed, admit it.</li>
        </ol>

        If you are found breaking any of these rules, you may be disqualified.
    </div>
    <div onclick="selectColumn('faq')"><div class="column_title"><h3><b>&raquo;</b> FAQ</h3></div></div>
    <div id="faq" class="column">
        <b>Q: </b><i>How do I eliminate my target?</i><br />
        <b>A: </b>Just clip them with your clothespin! However, be careful not to actually harm your victim, not to disrupt others, and review the rules.
        </p>
        <p>
        <b>Q: </b><i>Where do I get a clothespin?</i><br />
        <b>A: </b>You can either provide your own, or pick up your weapon from MTV-43-132. There should a few interns passing out clothespins. If not, simply take one from the bag. We recommend writing your kill code on it to make the game easier for everyone.
        </p>
        <p>
        <b>Q: </b><i>Is there a prize?</i><br />
        <b>A: </b>There will be a prize for the first place, as well as a badge for the top-ranking players. 
        </p>

    </div>
</div>

<div id="footer">
    <a href="{{ url }}">{{ url_linktext }}</a>
</div>

</div> <!-- wrapper -->
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript" src="/js/jquery.countdown.js"></script>
<script type="text/javascript" src="/js/main.js"></script>
<script type="text/javascript" src="/js/column.js"></script>
<script type="text/javascript">
jQuery(function() {
    {% if is_registered %}
        // Show countdown to game start
        var ts = new Date(2012, 7, 1, 10, 30).getTime();
        var event = "the games begin!";
    {% else %}
        // Show countdown to registration end
        var ts = new Date(2012, 6, 31, 20, 00).getTime();
        var event = "registration ends!";
    {% endif %}

    $('#countdown').countdown({
        timestamp	: ts,
        callback	: function(days, hours, minutes, seconds){
            var message = "";
            message += days + " day" + ( days==1 ? '':'s' ) + ", ";
            message += hours + " hour" + ( hours==1 ? '':'s' ) + ", ";
            message += minutes + " minute" + ( minutes==1 ? '':'s' ) + " and ";
            message += seconds + " second" + ( seconds==1 ? '':'s' ) + " <br />";
            message += "left until " + event;
            $('#note').html(message);
        }
    });
    
    var killform = $('#killform');
    if (killform.length) {
      killform.submit(function() {
        $.post(killform.attr('action'), killform.serialize(), function(data) {
          alert(data);
        });
        killform.children('#killcode').val('');
        return false;
      });
    }
    $('#killcode').focus();
});
</script>
</body>
</html>
